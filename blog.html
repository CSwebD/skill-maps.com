<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="google-adsense-account" content="ca-pub-7439109164508333">
  <title>Blog | Skill Maps</title>
  <link rel="icon" href="images/logo.jpg" type="image/x-icon">
  <meta name="description" content="Shape your future with structured learning pathways in Development, DevOps, Data, and AI." />
  <!-- Open Graph -->
  <meta property="og:title" content="Skill Maps" />
  <meta property="og:description" content="Interactive learning pathways in Development, DevOps, Data, and AI." />
  <meta property="og:url" content="https://www.skill-maps.com" />
  <meta property="og:image" content="https://www.skill-maps.com/images/logo.jpg" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" />
  <style>body { font-family: 'Inter', sans-serif; } html { scroll-behavior: smooth; }</style>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "name": "Skill Maps",
    "url": "https://www.skill-maps.com",
    "logo": "https://www.skill-maps.com/images/logo.jpg"
  }
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7439109164508333"
     crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZS5VZ74BH8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZS5VZ74BH8');
</script>
</head>


<body class="bg-gray-50 text-gray-800">

  <!-- Placeholder for the panel bar -->
  <div id="panel-bar-placeholder"></div>
  <script src="panel-nav.js"></script> 

<!-- HEADER -->
<main class="pt-24">
  <section class="bg-gradient-to-r from-[#fef3c7] to-[#fde68a] text-white py-8 text-center">
    <div class="max-w-3xl mx-auto px-6">
      <h1 class="text-5xl font-extrabold text-amber-800 drop-shadow mb-4">Blog</h1>
    </div>
  </section>

  <!-- SEARCH + ARTICLES -->
  <section class="py-16 bg-white">
    <div class="max-w-6xl mx-auto px-6">
      <div class="mb-8 max-w-md mx-auto">
        <input
          id="searchInput"
          type="text"
          placeholder="Search articles..."
          class="w-full px-4 py-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-green-500"
        />
      </div>

      <!-- Categories Filter -->
      <div class="flex flex-wrap justify-center gap-3 mb-10" id="categoryFilter">
        <button data-category="all" class="category-btn px-4 py-2 rounded-full bg-green-600 text-white font-medium hover:bg-green-700 transition">All</button>
        <button data-category="AI" class="category-btn px-4 py-2 rounded-full bg-gray-200 text-gray-800 hover:bg-green-600 hover:text-white transition">AI</button>
        <button data-category="Tech" class="category-btn px-4 py-2 rounded-full bg-gray-200 text-gray-800 hover:bg-green-600 hover:text-white transition">Tech</button>
        <button data-category="Development" class="category-btn px-4 py-2 rounded-full bg-gray-200 text-gray-800 hover:bg-green-600 hover:text-white transition">Development</button>
        <button data-category="OpenSource" class="category-btn px-4 py-2 rounded-full bg-gray-200 text-gray-800 hover:bg-green-600 hover:text-white transition">OpenSource</button>
        <button data-category="Design" class="category-btn px-4 py-2 rounded-full bg-gray-200 text-gray-800 hover:bg-green-600 hover:text-white transition">Design</button>
        <button data-category="Career" class="category-btn px-4 py-2 rounded-full bg-gray-200 text-gray-800 hover:bg-green-600 hover:text-white transition">Career</button>
        <button data-category="Research" class="category-btn px-4 py-2 rounded-full bg-gray-200 text-gray-800 hover:bg-green-600 hover:text-white transition">Research</button>
        <button data-category="CyberSecurity" class="category-btn px-4 py-2 rounded-full bg-gray-200 text-gray-800 hover:bg-green-600 hover:text-white transition">CyberSecurity</button>
      </div>


      <div id="blogGrid" class="grid gap-8 md:grid-cols-2 lg:grid-cols-3"></div>

      <div id="loadingIndicator" class="text-center mt-10 hidden">
        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"></div>
        <p class="mt-2 text-gray-600">Loading more articles...</p>
      </div>
    </div>
  </section>
</main>

<!-- SCRIPT -->
<script>
  let allArticles = [];
  let visibleCount = 0;
  let currentFilteredArticles = [];
  const increment = 6;
  let isLoading = false;

  const blogGrid = document.getElementById('blogGrid');
  const loadingIndicator = document.getElementById('loadingIndicator');
  const searchInput = document.getElementById('searchInput');
  const categoryBtns = document.querySelectorAll('.category-btn');

  // Get URL parameters
  function getURLParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
  }

  // Update button highlighting
  function updateCategoryButton(category) {
    categoryBtns.forEach(btn => {
      const btnCategory = btn.getAttribute('data-category');
      if (btnCategory === category) {
        btn.classList.remove('bg-gray-200', 'text-gray-800');
        btn.classList.add('bg-green-600', 'text-white');
      } else {
        btn.classList.remove('bg-green-600', 'text-white');
        btn.classList.add('bg-gray-200', 'text-gray-800');
      }
    });
  }

  // Filter articles by category
  function filterByCategory(category) {
    if (category === 'all' || !category) {
      currentFilteredArticles = allArticles;
    } else {
      currentFilteredArticles = allArticles.filter(article => article.category === category);
    }
    updateCategoryButton(category || 'all');
  }

  // CATEGORY FILTER BUTTONS
  categoryBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const category = btn.getAttribute('data-category');
      
      // Update URL
      const url = new URL(window.location);
      if (category === 'all') {
        url.searchParams.delete('category');
      } else {
        url.searchParams.set('category', category);
      }
      url.searchParams.delete('searchInput'); // Clear search when clicking category
      window.history.pushState({}, '', url);
      
      // Remove existing filter indicator
      const existingIndicator = document.getElementById('filter-indicator');
      if (existingIndicator) {
        existingIndicator.remove();
      }
      
      filterByCategory(category);
      
      // Add new filter indicator if not "all"
      if (category !== 'all') {
        addFilterIndicator(`Category: ${category}`, currentFilteredArticles.length);
      }
      
      visibleCount = 0;
      blogGrid.innerHTML = '';
      renderArticles();
    });
  });

  async function loadArticleData() {
    try {
      const res = await fetch('../blog/blog.json');
      allArticles = await res.json();
      
      // Check URL parameters
      const urlCategory = getURLParam('category');
      const urlSearch = getURLParam('searchInput');
      
      if (urlSearch) {
        // Handle search parameter
        searchInput.value = urlSearch;
        const query = urlSearch.toLowerCase();
        currentFilteredArticles = allArticles.filter(article => {
          const titleMatch = article.title && article.title.toLowerCase().includes(query);
          const descMatch = article.desc && article.desc.toLowerCase().includes(query);
          const categoryMatch = article.category && article.category.toLowerCase().includes(query);
          return titleMatch || descMatch || categoryMatch;
        });
        
        // Add visual indicator
        addFilterIndicator(`Search: "${urlSearch}"`, currentFilteredArticles.length);
      } else if (urlCategory) {
        // Handle category parameter
        filterByCategory(urlCategory);
        
        // Add visual indicator
        if (urlCategory !== 'all') {
          addFilterIndicator(`Category: ${urlCategory}`, currentFilteredArticles.length);
        }
      } else {
        // No parameters - show all
        currentFilteredArticles = allArticles;
      }
      
      renderArticles();
    } catch (error) {
      console.error("Could not load blog.json", error);
      blogGrid.innerHTML = "<p class='text-center text-gray-600'>Failed to load articles.</p>";
    }
  }

  // Add visual feedback for filtering
  function addFilterIndicator(filterText, count) {
    const indicator = document.createElement('div');
    indicator.id = 'filter-indicator';
    indicator.className = 'mb-6 p-4 bg-green-50 border-l-4 border-green-500 rounded';
    indicator.innerHTML = `
      <p class="text-green-800 font-medium">
        <i class="fas fa-filter mr-2"></i>
        Filtered by ${filterText} — Showing ${count} article${count !== 1 ? 's' : ''}
      </p>
    `;
    blogGrid.parentElement.insertBefore(indicator, blogGrid);
  }

  function createAdBlock() {
    const adContainer = document.createElement('div');
    adContainer.className = "col-span-1 md:col-span-2 lg:col-span-3 py-8 bg-gray-50";
    
    const innerDiv = document.createElement('div');
    innerDiv.className = "max-w-7xl mx-auto px-6";
    
    // Create the ad ins element
    const ins = document.createElement('ins');
    ins.className = 'adsbygoogle';
    ins.style.display = 'block';
    ins.setAttribute('data-ad-client', 'ca-pub-7439109164508333');
    ins.setAttribute('data-ad-slot', '4111274044');
    ins.setAttribute('data-ad-format', 'auto');
    ins.setAttribute('data-full-width-responsive', 'true');
    
    innerDiv.appendChild(ins);
    adContainer.appendChild(innerDiv);
    
    // Push to adsbygoogle after a slight delay to ensure DOM is ready
    setTimeout(() => {
      try {
        (adsbygoogle = window.adsbygoogle || []).push({});
      } catch (e) {
        console.log('AdSense error:', e);
      }
    }, 100);
    
    return adContainer;
  }

  function createArticleCard(article) {
    const cardLink = document.createElement('a');
    cardLink.href = article.link;
    cardLink.className = "block bg-gray-50 rounded-xl shadow hover:shadow-2xl transition overflow-hidden";

    const imgDiv = document.createElement('div');
    imgDiv.className = "h-40 bg-cover bg-center cursor-pointer";
    imgDiv.style.backgroundImage = `url('${article.image}')`;

    const content = document.createElement('div');
    content.className = "p-6";
    content.innerHTML = `
      <h3 class="text-xl font-semibold mb-2">${article.title}</h3>
      <p class="text-sm text-gray-500 mb-1">${new Date(article.date).toLocaleDateString()}</p>
      <p class="text-sm text-gray-600 mb-4">${article.desc}</p>
      <span class="text-green-700 font-semibold hover:underline">Read More →</span>
    `;

    cardLink.appendChild(imgDiv);
    cardLink.appendChild(content);
    return cardLink;
  }

  function renderArticles() {
    if (isLoading || visibleCount >= currentFilteredArticles.length) return;
    
    isLoading = true;
    loadingIndicator.classList.remove('hidden');

    // Simulate slight delay for better UX
    setTimeout(() => {
      const articlesToShow = currentFilteredArticles.slice(visibleCount, visibleCount + increment);
      
      articlesToShow.forEach((article, index) => {
        const card = createArticleCard(article);
        blogGrid.appendChild(card);
        
        // Add ad after every 6 articles
        if ((visibleCount + index + 1) % 6 === 0 && (visibleCount + index + 1) < currentFilteredArticles.length) {
          const adBlock = createAdBlock();
          blogGrid.appendChild(adBlock);
        }
      });

      visibleCount += increment;
      isLoading = false;
      loadingIndicator.classList.add('hidden');
    }, 300);
  }

  // Infinite scroll implementation
  function handleScroll() {
    const scrollPosition = window.innerHeight + window.scrollY;
    const documentHeight = document.documentElement.scrollHeight;
    
    // Trigger when user is 800px from bottom (approximately when ad appears)
    if (scrollPosition >= documentHeight - 800 && !isLoading && visibleCount < currentFilteredArticles.length) {
      renderArticles();
    }
  }

  // Throttle scroll event for better performance
  let scrollTimeout;
  window.addEventListener('scroll', () => {
    if (scrollTimeout) {
      clearTimeout(scrollTimeout);
    }
    scrollTimeout = setTimeout(handleScroll, 100);
  });

  searchInput.addEventListener('input', e => {
    const q = e.target.value.toLowerCase();
    
    // Update URL
    const url = new URL(window.location);
    if (q) {
      url.searchParams.set('searchInput', q);
      url.searchParams.delete('category'); // Clear category when searching
    } else {
      url.searchParams.delete('searchInput');
    }
    window.history.pushState({}, '', url);
    
    currentFilteredArticles = allArticles.filter(article =>
      article.title.toLowerCase().includes(q) || article.desc.toLowerCase().includes(q)
    );
    visibleCount = 0;
    blogGrid.innerHTML = '';
    renderArticles();
  });

  window.addEventListener('DOMContentLoaded', loadArticleData);
</script>

    <!-- Placeholder for the footer -->
    <div id="footer-placeholder"></div>
    <script src="analytics.js"></script>
    <script src="nav-switcher.js"></script>
    <script src="footer.js"></script>

</body>
</html>